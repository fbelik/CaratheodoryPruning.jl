<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Background · CaratheodoryPruning.jl</title><meta name="title" content="Background · CaratheodoryPruning.jl"/><meta property="og:title" content="Background · CaratheodoryPruning.jl"/><meta property="twitter:title" content="Background · CaratheodoryPruning.jl"/><meta name="description" content="Documentation for CaratheodoryPruning.jl."/><meta property="og:description" content="Documentation for CaratheodoryPruning.jl."/><meta property="twitter:description" content="Documentation for CaratheodoryPruning.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">CaratheodoryPruning.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Background</a></li><li><a class="tocitem" href="kerneldowndater.html">Kernel Downdaters</a></li><li><a class="tocitem" href="pruning.html">Pruning</a></li><li><a class="tocitem" href="ondemand.html">On Demand Matrices</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Background</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fbelik/CaratheodoryPruning.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fbelik/CaratheodoryPruning.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CaratheodoryPruning.jl-Documentation"><a class="docs-heading-anchor" href="#CaratheodoryPruning.jl-Documentation">CaratheodoryPruning.jl Documentation</a><a id="CaratheodoryPruning.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#CaratheodoryPruning.jl-Documentation" title="Permalink"></a></h1><p><strong>Carathéodory&#39;s theorem</strong> is a theorem in convex geometry relating to a minimal number of points in <span>$\R^N$</span> required to enclose some point. Suppose that you have a set of points <span>$P \in \mathbb{R}^N$</span> with <span>$|P| &gt; N$</span>. Additionally, let <span>$\mathbf{x} \in \text{conv}(P)$</span>, the convex hull of <span>$P$</span>. This means that <span>$\mathbf{x}$</span> can be written as a positive linear combination of the points in <span>$P$</span> where the coefficients sum to one. The theorem states that there exists a subset <span>$Q\subset P$</span> with <span>$|Q|=N+1$</span> such that <span>$\mathbf{x} \in \text{conv}(Q)$</span>. In <span>$N=2$</span> dimensions, this means that given some number of points that enclose <span>$\mathbf{x}$</span>, we can always prune these down to three points, or a triangle, that enclose <span>$\mathbf{x}$</span>.</p><p><img src="caratheodory.png" alt/></p><p>This theorem also extends to conic hulls, where the coefficients of the linear combination need not add to one, they simply need to be nonnegative. In the conic case, with <span>$\mathbf{x} \in \text{cone}(P)$</span>, the conic hull of <span>$P$</span>, there exists a subset <span>$Q\subset P$</span> with <span>$|Q|=N$</span> such that <span>$\mathbf{x} \in \text{cone}(Q)$</span>.</p><p>We can write out the conic version of Carathéodory&#39;s theorem as follows. Denote the points in <span>$P$</span> as <span>$\mathbf{p}_1, \ldots, \mathbf{p}_M$</span>. Also define be the matrix</p><p class="math-container">\[\mathbf{P} = \begin{bmatrix} 
\vert &amp; \vert &amp;  &amp; \vert\\
\mathbf{p}_1 &amp; \mathbf{p}_2 &amp; \cdots &amp; \mathbf{p}_M\\
\vert &amp; \vert &amp; &amp; \vert\\
\end{bmatrix} \in \mathbb{R}^{N \times M}.\]</p><p>The statement that <span>$\mathbf{x}\in\text{cone}(P)$</span> implies that there exists a <strong>nonnegative</strong> vector of weights, <span>$\mathbf{w} \in \mathbb{R}^M$</span>, such that</p><p class="math-container">\[\mathbf{P} \mathbf{w} = \mathbf{x}.\]</p><p>Carathéodory&#39;s theorem states that we can form a subset of points <span>$Q \subset P$</span>, such that we get a new set of <strong>nonnegative</strong> weights, <span>$\mathbf{v}\in\mathbb{R}^{N}$</span>, satisfying</p><p class="math-container">\[\mathbf{Q} \mathbf{v} = \begin{bmatrix} 
\vert &amp; \vert &amp;  &amp; \vert\\
\mathbf{p}_{i_1} &amp; \mathbf{p}_{i_2} &amp; \cdots &amp; \mathbf{p}_{i_N}\\
\vert &amp; \vert &amp; &amp; \vert\\
\end{bmatrix} \mathbf{v} = \mathbf{x} = \mathbf{P} \mathbf{w}.\]</p><p>Once the row indices, <span>$i_1, \ldots, i_N$</span>, are sampled, we can obtain the new weights by performing a linear solve on the matrix equation <span>$\mathbf{Q} \mathbf{v} = \mathbf{x}$</span>.  However, the difficulty in this problem is in subsampling the correct row indices such that the new weights are all nonnegative. The goal of having nonnegative weights can be useful in problems such as numerical quadrature where negative weights could lead to numerical instability. </p><p><code>CaratheodoryPruning.jl</code> implements various algorithms for this row index subselection problem.</p><p>The base Carathéodory pruning method takes in a matrix <code>V</code> of size <code>M</code> by <code>N</code>, or the transpose of the <span>$\mathbf{P}$</span> matrix above. It also takes in a vector of nonnegative weights <code>w_in</code> of length <code>M</code>. It then returns a nonnegative pruned vector, <code>w</code>, of length <code>M</code>, and a vector of row indices of length <code>N</code>, <code>inds</code>, such that <code>V[inds,:]&#39; * w[inds]</code> is approximately equal to <code>V&#39; * w_in</code>. If <code>return_errors</code> is set to true, it additionally returns a vector of moment errors at each iteration.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CaratheodoryPruning.caratheodory_pruning" href="#CaratheodoryPruning.caratheodory_pruning"><code>CaratheodoryPruning.caratheodory_pruning</code></a> — <span class="docstring-category">Function</span></header><section><div><p><code>caratheodory_pruning(V, w_in, kernel_downdater, prune_weights![; caratheodory_correction=true, progress=false, zero_tol=1e-16, return_error=false, errnorm=norm])</code></p><p>Base method for Caratheodory pruning of the matrix <code>V</code> and weights <code>w_in</code>. Returns a new set of weights, <code>w</code>, a set of indices, <code>inds</code>, and an error <code>err</code> such that <code>w</code> only has nonzero elements at the indices, <code>inds</code>, and</p><ul><li>if <code>size(V,1) &gt; size(V,2)</code>, <code>||Vᵀw_in - V[inds,:]ᵀw_in[inds]|| = err ≈ 0</code></li><li>if <code>size(V,1) &lt; size(V,2)</code>, <code>||V w_in - V[inds,:] w_in[inds]|| = err ≈ 0</code></li></ul><p>Note that if <code>return_error=false</code> and <code>caratheodory_correction=false</code>, the error is not computed and a default return value of 0.0 is used.</p><p>Uses the <code>kernel_downdater</code> object to generate kernel vectors for pruning, and the <code>prune_weights!</code> method to prune weights after kernel vectors have been formed.</p><p>If <code>caratheodory_correction=true</code>, uses a linear solve at the end to reduce error in the moments.</p><p>If <code>progress=true</code>, displays a progress bar.</p><p><code>zero_tol</code> determines the tolerance for a weight equaling zero.</p><p>If <code>return_error=true</code> or <code>caratheodory_correction=true</code>, computes the  corresponding errors in moments, <code>err</code>. If both <code>return_error</code> and <code>caratheodory_correction</code> are set to <code>false</code>, <code>err</code> is set to 0.0.</p><p><code>errornorm</code> is the method called on the truth moments vs computed moments to evaluate final error, only used if <code>caratheodory_correction=true</code>  or <code>return_error=true</code>. Defaults to LinearAlgebra.jl&#39;s norm method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/CaratheodoryPruning.jl/blob/627a748cdbcbf6f4161e39af764cd2105aaa947e/src/caratheodory.jl#L1-L30">source</a></section><section><div><p><code>caratheodory_pruning(V, w_in[; kernel=:GivensUpDown, pruning=:first, caratheodory_correction=true, return_error=false, errnorm=norm, zero_tol=1e-16, progress=false, kernel_kwargs...])</code></p><p>Helper method for calling the base <code>caratheodory_pruning</code> method.</p><p>Takes in a symbol for <code>kernel</code>, and forms a <code>KernelDowndater</code> object depending on what is passed in. Also passes additional kwargs into the <code>KernelDowndater</code>:</p><p>Options include <code>:FullQRDowndater</code> or <code>:FullQR</code>, <code>:GivensDowndater</code> or <code>:Givens</code>, <code>:CholeskyDowndater</code> or <code>:Cholesky</code>, <code>:FullQRUpDowndater</code> or <code>:FullQRUpDown</code>, and <code>:GivensUpDownDater</code> or <code>:GivensUpDown</code>.</p><p>Takes in a symbol for <code>pruning</code>, and chooses a pruning method depending on what is passed in. Options are <code>:first</code> or <code>:minabs</code>.</p><p>See the other <code>caratheodory_pruning</code> docstring for info on other arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fbelik/CaratheodoryPruning.jl/blob/627a748cdbcbf6f4161e39af764cd2105aaa947e/src/caratheodory.jl#L133-L149">source</a></section></article><p>The implemented methods for Carathéodory pruning are iterative kernel-based algorithms. This means that at each step, kernel vectors for the transpose of <code>V[inds,:]</code> are formed so that they can be used to pivot the weights without changing the moments. The pivot is chosen to ensure that (at least) one of the weights are set to zero, and the rest are still nonnegative. This iteration is then repeated until <code>M - N</code> of the row indices are pruned, and we are left with <code>N</code> row indices.</p><p>Here is a full example of generating a random matrix <code>V</code> and random, positive vector of weights <code>w_in</code>, computing the moments <code>eta</code>, using <code>caratheodory_pruning</code> to generate pruned weights <code>w</code>, and computing the moment error.</p><pre><code class="language-julia hljs">using CaratheodoryPruning
using Random
M = 100
N = 10
V = rand(M, N)
w_in = rand(M)
eta = V&#39; * w_in
w, inds = caratheodory_pruning(V, w_in)
w[inds]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10-element Vector{Float64}:
  6.024729738575634
  6.453835375942296
  3.929483809621981
  2.9016573147807136
  7.451269086546258
 14.833288666800724
  1.8868570997858618
  5.684190887232419
  0.5472984525001309
  5.739878063461836</code></pre><pre><code class="language-julia hljs">error = maximum(abs.(V[inds,:]&#39; * w[inds] .- eta))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.7763568394002505e-14</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="kerneldowndater.html">Kernel Downdaters »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 8 April 2025 15:11">Tuesday 8 April 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
